---
import versionRaw from "../../VERSION?raw";
import BaseHead from "../components/BaseHead.astro";

interface Props {
  frontmatter: {
    title: string;
    description?: string;
    image?: string;
  };
}

const { frontmatter } = Astro.props;
const base = import.meta.env.BASE_URL;
const version = versionRaw.trim();

// Build metadata from environment variables
const commitHash = import.meta.env.PUBLIC_COMMIT_HASH || "dev";
const buildId = import.meta.env.PUBLIC_BUILD_ID || "local";
const repoUrl =
  import.meta.env.PUBLIC_REPO_URL || "https://github.com/aretw0/astro-vault";
const shortHash = commitHash.substring(0, 7);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead
      title={frontmatter.title}
      description={frontmatter.description}
      image={frontmatter.image}
    />
  </head>
  <body>
    <header
      class="container"
      style="padding-top: 2rem; padding-bottom: 2rem; border-bottom: 1px solid var(--border);"
    >
      <nav style="display: flex; align-items: center; gap: 1.5rem;">
        <a
          href={base}
          style="font-weight: bold; font-size: 1.5rem; color: var(--text-normal); text-decoration: none;"
          aria-label="PÃ¡gina inicial do Astro Vault"
        >
          ðŸŒ± Astro Vault
        </a>
        <span style="color: var(--border);" aria-hidden="true">|</span>
        <a
          href={base}
          style="font-weight: 600; font-size: 1.125rem; color: var(--text-normal);"
          >InÃ­cio</a
        >
        <a
          href={`${base}/guide`.replace(/\/\//g, "/")}
          style="font-weight: 600; font-size: 1.125rem; color: var(--text-normal);"
          >Guia</a
        >
        <a
          href={`${base}/docs`.replace(/\/\//g, "/")}
          style="font-weight: 600; font-size: 1.125rem; color: var(--text-normal);"
          >Docs</a
        >
        <div style="flex-grow: 1;"></div>
        <a
          href={repoUrl}
          target="_blank"
          rel="noopener noreferrer"
          style="display: flex; align-items: center; gap: 0.5rem; color: var(--text-muted); text-decoration: none; font-size: 0.9rem;"
        >
          <svg
            height="20"
            viewBox="0 0 16 16"
            width="20"
            style="fill: currentColor;"
            aria-hidden="true"
          >
            <path
              d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"
            ></path>
          </svg>
          <span>v{version}</span>
        </a>
      </nav>
    </header>

    <main class="container">
      <article class="content">
        <slot />
      </article>
    </main>

    <footer
      class="container"
      style="margin-top: 4rem; padding-top: 2rem; padding-bottom: 2rem; border-top: 1px solid var(--border); color: var(--text-muted); font-size: 0.8rem; display: flex; flex-direction: row; gap: 0.5rem;"
    >
      <div style="flex-grow: 1;"></div>
      <p>Built with Astro Vault ðŸŒ±</p>
      <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <span>Version: v{version}</span>
        <span>Commit: <code style="font-size: 0.75rem;">{shortHash}</code></span
        >
        <span>Build: <code style="font-size: 0.75rem;">{buildId}</code></span>
      </div>
      <div style="flex-grow: 1;"></div>
    </footer>
  </body>
</html>
